<!-- BEGIN CONTENT BODY -->
<div class="page-content" style="min-height:785px">
    <div class="row">
        <section class="col-md-10 margincontent">
            <!-- BEGIN EXAMPLE TABLE PORTLET-->
            <section style="margin-bottom: 50px;">
                <button type="button" class="btn default pull-left" ui-sref="reports"> Back </button>
            </section>
            <section class="portlet light bordered portletcustom" style="padding:0;">
                <section class="portlet-title">
                    <div class="caption font-dark" style="padding-left:20px;padding-top:15px;">
                        <span class="caption-subject bold uppercase"> Transaction Report</span>
                    </div>
                </section>
                <section class="portlet-body">
                    <section class="table-toolbar">
                        <div class="row">
                            <form class="paymentreport-form" ng-submit="vm.handleFilterClicked(vm.filterData)">
                                <div class="col-xs-12">
                                    <section class="form-group col-xs-12">
                                        <div class="col-xs-3">
                                            <section class="form-group form-md-line-input has-info" style="padding:0px;">
                                                <div class="col-xs-12">
                                                    <select class="form-control" name="merchant" id="merchant" ng-options="merchant.id as merchant.name for merchant in vm.merchantList" ng-model="vm.filterData.merchantId">
                                                        <option value="" disabled selected hidden>All Merchants</option>
                                                    </select>
                                                </div>
                                            </section>
                                        </div>
                                        <div class=" col-xs-3">
                                            <section class="input-group offerstartdate" style="margin-bottom:15px;">
                                                <div class="input-group-addon input-circle-left"><a ng-click="openFrom($event)"><i class="fa fa-calendar"></i></a></div>
                                                <input type="text" class="form-control input-circle-right dateinput" uib-datepicker-popup="dd/MM/yyyy" is-open="status.opened1" min-date="startDate" max-date="minDate" datepicker-mode="day" show-weeks="false" clear-text="false" show-button-bar="false" name="fromDate" ng-model="vm.filterData.fromDate" placeholder="From Date" style="width:97%" />
                                            </section>
                                        </div>
                                        <div class=" col-xs-3">
                                            <section class="input-group offerstartdate" style="margin-bottom:15px;">
                                                <div class="input-group-addon input-circle-left"><a ng-click="openTo($event)"><i class="fa fa-calendar"></i></a></div>
                                                <input type="text" class="form-control input-circle-right dateinput" uib-datepicker-popup="dd/MM/yyyy" is-open="status.opened2" min-date="m.filterData.fromDate" max-date="minDate" datepicker-mode="day" show-weeks="false" clear-text="false" show-button-bar="false" name="toDate" ng-model="vm.filterData.toDate" placeholder="To Date" style="width:97%" />
                                            </section>
                                        </div>
                                        <div class="col-xs-3" style="margin-bottom:15px;">
                                            <section class="form-group form-md-line-input has-info" style="padding:0px;">
                                                <div class="col-xs-12">
                                                    <select class="form-control" name="user" id="user" ng-options="user.id as user.name for user in vm.users" ng-model="vm.filterData.userId">
                                                        <option value="" disabled selected hidden>All Users</option>
                                                    </select>
                                                </div>
                                            </section>
                                        </div>
                                    </section>
                                </div>
                                <div class="col-md-6">
                                    <div class="btn-group" style="margin-left:20px;padding-left:30px;">
                                        <button type="submit" class="btn sbold blue"> Generate Report </button>
                                    </div>
                                    <div class="btn-group" style="padding-left:30px;">
                                        <button type="button" class="btn sbold red" ng-click="vm.clearFilters()"> Clear Filter </button>
                                    </div>
                                </div>
                                <div class="col-md-6 pull-right">
                                    <div class="btn-group" style="margin-right:50px;float:right;">
                                        <button type="button" class="btn sbold green" ng-click="vm.exportData()"> Export as Excel
                                            <i class="fa fa-exchange"></i>
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </section>
                </section>
                <div class="dataTables_wrapper no-footer">
                    <div class="table-scrollable">
                        <table class="table table-striped table-bordered table-hover order-column dataTable no-footer" datatable="ng">
                            <thead>
                                <tr role="row" style="text-align:center;">
                                    <th style="width: 100px;"> Sr No. </th>
                                    <th class="sorting" style="width:100px;"> Merchant Name</th>
                                    <th style="width: 100px;"> User Name </th>
                                    <th style="width: 100px;"> Order number </th>
                                    <th style="width: 108px;"> Transaction ID </th>
                                    <th style="width: 119px;"> Transaction Date </th>
                                    <th style="width: 119px;"> Payment Amount(Rs) </th>
                                    <th style="width: 220px;"> Cashback by Offer </th>
                                    <th style="width: 220px;"> Cashback by PromoCode </th>
                                    <th style="width: 119px;"> Gross Settlement(Rs)</th>
                                    <th style="width: 119px;"> Transaction cancelled by </th>
                                    <th style="width: 119px;"> Transaction cancelled on </th>
                                    <th style="width: 220px;"> Cancellation Description </th>
                                    <th style="width: 120px;"> Action </th>
                                </tr>
                            </thead>
                            <tbody class="datatablecustom">
                                <tr class="gradeX odd" role="row" ng-repeat="reportData in vm.reportsData" style="text-align:center;">
                                    <td>{{$index + 1}}</td>
                                    <td>{{reportData.merchantName}}</td>
                                    <td>{{reportData.userName?reportData.userName:''}}</td>
                                    <td>{{reportData.orderNumber}}</td>
                                    <td>{{reportData.transactionId}}</td>
                                    <td>{{reportData.transactionDate |date:shortDate}}</td>
                                    <td>{{reportData.paymentAmount | number:2}}</td>
                                    <td>{{reportData.cashbackByOffer | number:2}}</td>
                                    <td>{{reportData.cashbackByPromo | number:2}}</td>
                                    <td>{{reportData.amountCreditedToBatua | number:2}}</td>
                                    <td>{{reportData.transactionCancelledBy?reportData.transactionCancelledBy:''}}</td>
                                    <td>{{reportData.transactionCancelledOn?(reportData.transactionCancelledOn |date:shortDate):''}}</td>
                                    <td>{{reportData.cancellationDescription?reportData.cancellationDescription:''}}</td>
                                    <td><span ng-if="!reportData.transactionCancelledOn"><a type="button" ng-if="reportData.transactionCancelledOn == null" class="btn button-color" ui-sref="cancelTransaction({paymentId:reportData.id})" >Cancel Transaction</a></span>
                                        <span class="label label-sm label-success center" ng-if="reportData.transactionCancelledOn != null">Cancelled</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </section>
    </div>
    <!-- END EXAMPLE TABLE PORTLET-->
</div>
